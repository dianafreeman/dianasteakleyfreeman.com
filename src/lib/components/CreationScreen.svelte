<script>
  import { onMount } from "svelte";
  import { spring } from "svelte/motion";
  import { derived, readable, writable } from "svelte/store";

  let svg;
  let pathsInOrder = [];

  const s0 = spring(0);
  const s1 = spring(0);
  const s2 = spring(0);
  const s3 = spring(0);
  const s0length = spring(0);
  const s1length = spring(0);
  const s2length = spring(0);
  const s3length = spring(0);
  const dashOffsetSprings = [s0, s1, s2, s3];
  const lengths = [s0length, s1length, s2length, s3length];

  onMount(() => {
    const paths = svg.querySelectorAll("path:not(defs path)");
    const lines = svg.querySelectorAll("line:not(defs line)");
    pathsInOrder = [paths[0], paths[1], lines[0], paths[2]];

    dashOffsetSprings.forEach((spring, idx) => {
      const path = pathsInOrder[idx];
      spring.set(path.getTotalLength());
    });
    lengths.forEach((length, idx) => {
      const path = pathsInOrder[idx];
      length.set(path.getTotalLength());
    });
    // pathsInOrder.forEach(function (item, idx) {
    //   // console.log('total length', item.getTotalLength())
    //   s0.set()

    //   item.style.strokeDasharray = item.style.strokeDashoffset = item.getTotalLength() //springs[idx].set(i.getTotalLength());
    // });
  });

  function update() {
    dashOffsetSprings.forEach(function (spring, idx) {
      setTimeout(() => {
        spring.set(0, { duration: 1000 });
      }, 1000 * idx);
    });
  }
</script>

<div class="bg-neutral-300 shadow h-full w-full rounded-md p-2 ">
  <div id="buttons" class="flex flex-row w-full justify-start ">
    <div class="bg-red-500 rounded-full h-3 w-3 mr-2" />
    <div class="bg-yellow-500 rounded-full h-3 w-3 mr-2" />
    <div class="bg-green-500 rounded-full h-3 w-3 mr-2" />
  </div>

  <div class="flex mt-2">
    <div id="left-toolbar" class="flex flex-col h-full w-5">
      {#each Array(23) as _thing}
        <div class="bg-neutral-200 rounded-full h-1 w-3 my-1" />
      {/each}
    </div>
    <div class="p-2 text-xl bg-white text-black rounded-sm flex-1">
      <button on:click={() => update()}>go</button>
      <!-- SVG Start -->
      <div style="min-height: 300px;" class="flex flex-col justify-around">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 465.39 200.31" bind:this={svg}>
          <defs>
            <clipPath id="myClipPath">
              <path
                fill="#000"
                d="M399.6,292.8c.72,0,1.72,0,2.72,0,4.12-.08,8.24-.13,12.36-.27a382.67,382.67,0,0,1,40.36,1c9.82.69,19.62,1.74,29.42,2.61a12.84,12.84,0,0,0,2.4-.05,1.58,1.58,0,0,0,1.24-1.51,7.21,7.21,0,0,0-4.9-6.54,35.77,35.77,0,0,0-3.87-.59c-6.29-.69-12.58-1.33-18.87-2.05a332.67,332.67,0,0,0-34-2.25c-7.23-.08-14.47.07-21.7.1-.87,0-1.8.32-2.73-.45a24.69,24.69,0,0,1,.9-3.39c2.61-9.27,5.24-18.52,7.82-27.8.53-1.93.83-3.92,1.25-5.88a3,3,0,0,0-1.27-3.16,7.94,7.94,0,0,0-1.82-1c-1.43-.53-2.26-.24-2.93,1.2a67.15,67.15,0,0,0-2.72,6.36c-3.47,9.73-6.86,19.49-10.27,29.24-.6,1.7-1.17,3.4-1.83,5.34-.94.08-1.63.16-2.32.2a298.17,298.17,0,0,0-29.69,2.83,143.22,143.22,0,0,0-25.1,6.22,41.13,41.13,0,0,0-4.93,2.23,6.94,6.94,0,0,0-2.81,2.67,4.3,4.3,0,0,0-.1,4.84,17.53,17.53,0,0,0,2.73,3.17,17.23,17.23,0,0,0,5.47,3.1c2.25.86,4.52,1.68,6.78,2.51,8.41,3.07,15.74,7.95,22.63,13.55a46.74,46.74,0,0,1,4.11,4c.2.21.39.43.58.65q-.19.15-.42.36c-3,2.85-5.88,5.77-8.95,8.49a88.84,88.84,0,0,1-15.26,11.22,34,34,0,0,1-7.77,3.21,13.62,13.62,0,0,1-5.34.66,2.18,2.18,0,0,1-2.13-1.79,20.41,20.41,0,0,1-.52-4.16,63.34,63.34,0,0,1,.7-7.78c.45-2.77,1.27-5.47,1.76-8.23a8.1,8.1,0,0,0-2.46-7.93c-2-1.79-2.79-1.38-4,.14-.38.46-.8.89-1.22,1.32-3.41,3.55-6.76,7.15-10.26,10.61a52,52,0,0,1-11.19,8.6,35.26,35.26,0,0,1-4.68,2,5.78,5.78,0,0,1-1.67.11c-.29-2.49-.26-3.08.61-5.11A28.65,28.65,0,0,1,303,331.17a13.86,13.86,0,0,1,11.32-3.81,11.77,11.77,0,0,0,2-.08c.34-1.35-.44-2.09-1.1-2.8-3.58-3.88-8.49-5.45-14-3.13a25.58,25.58,0,0,0-13.46,13.58,13.09,13.09,0,0,0-.62,1.64c-.22.29-.44.59-.66.87a84.67,84.67,0,0,1-6.49,7.29,88.31,88.31,0,0,1-18.62,14.19,69.73,69.73,0,0,1-8.53,3.74,14.18,14.18,0,0,1-5,.74,7.81,7.81,0,0,1-7.51-4.57c-2.18-4.06-2.47-8.36-1.9-12.88a12.74,12.74,0,0,1,1.45-.55C250,343,258,337.31,264.45,329.2a19.77,19.77,0,0,0,2.07-3.31,5.88,5.88,0,0,0-.41-6.27,10.73,10.73,0,0,0-1.75-2.05A13.41,13.41,0,0,0,251,314.43a27.88,27.88,0,0,0-11.58,6.79,38.91,38.91,0,0,0-6.79,8.44,5.89,5.89,0,0,0-1.25,1.25c-2.92,3.83-5.8,7.69-8.78,11.48a276.57,276.57,0,0,1-18.5,21.8c-2.79,2.88-5.78,5.58-8.75,8.27a18.71,18.71,0,0,1-7.11,4,2.09,2.09,0,0,1-.85.12c-1.2-.18-1.47-2.67-1.64-3.59a13.68,13.68,0,0,1-.06-4,42.44,42.44,0,0,1,5.47-16.13,250,250,0,0,1,14.21-22.7c.39-.56.72-1.17,1.07-1.75a23.25,23.25,0,0,0-1-2.59,3.24,3.24,0,0,0-4.51-1.59c-1.22.48-2.41,1-3.62,1.49a44.4,44.4,0,0,1-10.79,2.64c.47-.76.74-1.26,1.06-1.71,1.4-2,3-3.83,4.21-5.87,3.26-5.31,2.57-9.46-2.68-13.63a8.84,8.84,0,0,0-1.26-.83,6.89,6.89,0,0,0-6.9-.25,18.42,18.42,0,0,0-9.46,11.52,9.78,9.78,0,0,0,.78,7.31,17.15,17.15,0,0,0,4.69,5.75,9.56,9.56,0,0,0-1.57,1.92,162.41,162.41,0,0,1-15.54,19.92,160.4,160.4,0,0,1-18.29,17.54c-9.93,8.09-20.44,15.21-32.42,20a54.73,54.73,0,0,1-13.65,3.57q-11.92,1.5-18.67-8.4a32.51,32.51,0,0,1-5.25-12.71,63.94,63.94,0,0,1,.31-21.86,104.16,104.16,0,0,1,7.32-24.44A175.19,175.19,0,0,1,103,286.29c14.48-18.09,33.24-34.69,54.59-44.1,5-2.19,10.12-4.86,15.62-3.35a4.22,4.22,0,0,1,3.17,4,17.75,17.75,0,0,1-.29,6,37.46,37.46,0,0,1-6.46,13.48A57.34,57.34,0,0,1,154.27,277c-1.88,1.23-11.83,5-10.06,7.89,2.15,3.56,9.57-1.05,12.12-2.41a54.15,54.15,0,0,0,11.22-8.15c6.72-6.31,13.32-14.95,13.58-24.54.23-8.55-4.71-16.19-13.47-17.65C151,229.38,130.54,242,118.3,251.7a180.1,180.1,0,0,0-53.16,68.58,114.11,114.11,0,0,0-9,30.8,61.73,61.73,0,0,0,1,23.61c2.59,10.49,9,17.73,19,21.85.92.39,1.87.72,2.83,1,9.24,2.94,17.45,1.94,26.85-.15,12.34-2.75,23.43-8.24,33.7-15.5a137.51,137.51,0,0,0,13.63-11A191.86,191.86,0,0,0,179,341.56c1.2-1.67,2.52-3.24,3.71-4.91a6.6,6.6,0,0,0,1.24-2.68,17.19,17.19,0,0,0,6,.15c1.07-.17,2.12-.38,3.67-.65-.87,1.19-1.45,2-2,2.78-2.87,4.11-5.84,8.16-8.57,12.37a38,38,0,0,0-5.91,16.26,16.43,16.43,0,0,0,1.4,9.09c2.39,5.15,9.1,8.42,15,5.86a30.59,30.59,0,0,0,7-4.13,67,67,0,0,0,8.76-8.25q9.72-11.06,18.82-22.62c0,.67-.05,1.35,0,2,.06,8.94,4.18,15.54,12.61,19.08,7.51,3.16,15,3.41,22.36-.5,2.56-1.36,5.13-2.75,7.57-4.32a96.47,96.47,0,0,0,17.66-14.53,15.9,15.9,0,0,0,5.33,5.49,8.43,8.43,0,0,0,5.75,1.28,16.81,16.81,0,0,0,7.29-2.68,72,72,0,0,0,6.77-5c2.31-1.93,4.41-4.1,6.62-6.14.49-.45,1-.83,1.89-1.51-.12,1.11-.14,1.78-.26,2.44a18.11,18.11,0,0,0,.41,7.75c1.38,5.52,7.16,10.41,13.43,10a20.09,20.09,0,0,0,7.27-1.75c2.81-1.32,5.6-2.71,8.28-4.29,7.81-4.58,14.5-10.57,21-16.8a11.19,11.19,0,0,1,.17,7.54c-6.49,20.35-12.84,40.75-19.2,61.15-1.07,3.44-2,6.93-2.94,10.41a13.27,13.27,0,0,0-.32,2.68,1.44,1.44,0,0,0,1,1.4,7.89,7.89,0,0,0,5.6.14,4.48,4.48,0,0,0,2.9-2.85c.91-2.11,1.77-4.26,2.51-6.44,8.15-24.14,15.88-48.41,23.49-72.72q6.39-20.38,12.79-40.76C398.27,294.91,398.3,293.71,399.6,292.8ZM239.49,340.49c2.62-8.47,7.54-15.17,15.32-19.6a20.78,20.78,0,0,1,4.16-1.63,3.66,3.66,0,0,1,3.16.38,4,4,0,0,1-.38,3.76,34.52,34.52,0,0,1-2.92,4.52,48.64,48.64,0,0,1-12.46,10.71,37.6,37.6,0,0,1-7.1,3.7A11.91,11.91,0,0,1,239.49,340.49Zm-58.28-13.25a2.64,2.64,0,0,1-1.59.61,1.87,1.87,0,0,1-1.81-1.68,7.76,7.76,0,0,1,.41-4.43,19.93,19.93,0,0,1,8.08-10.14,2.79,2.79,0,0,1,2.91-.39,4.64,4.64,0,0,1,.11,4.27A32.54,32.54,0,0,1,181.21,327.24Zm206.37-32.48c-4,12.5-8,25-12.16,37.75a17.09,17.09,0,0,1-1.2-1.27,50.93,50.93,0,0,0-9.36-9.76c-7.93-6.37-16.25-12.12-25.88-15.74-.84-.32-1.69-.64-2.52-1a10.74,10.74,0,0,1-1.2-.73,12.47,12.47,0,0,1,1.37-1.15,26.81,26.81,0,0,1,7-2.76,184.89,184.89,0,0,1,22.69-4.69c6.37-.83,12.79-1.32,19.19-1.94.68-.06,1.38,0,2.19,0A7.32,7.32,0,0,1,387.58,294.76Z"
              />
              <path
                fill="#000"
                d="M509.48,331.17c-1.58-2.54-3.25-2.63-5.06-.26-2.93,3.83-5.81,7.69-8.78,11.48a278.84,278.84,0,0,1-18.51,21.8c-2.78,2.88-5.77,5.58-8.75,8.27a18.6,18.6,0,0,1-7.1,4,2.09,2.09,0,0,1-.85.12c-1.2-.18-1.47-2.67-1.64-3.59a13.69,13.69,0,0,1-.07-4,42.61,42.61,0,0,1,5.47-16.13,252.18,252.18,0,0,1,14.21-22.7c.4-.56.72-1.17,1.08-1.75a25.35,25.35,0,0,0-1.05-2.59,3.25,3.25,0,0,0-4.52-1.59c-1.21.48-2.4,1-3.62,1.49a44.32,44.32,0,0,1-10.78,2.64c.47-.76.73-1.26,1.06-1.71,1.4-2,2.95-3.83,4.2-5.87,3.27-5.31,2.57-9.46-2.68-13.63a9.34,9.34,0,0,0-1.25-.83,6.89,6.89,0,0,0-6.9-.25,18.42,18.42,0,0,0-9.46,11.52,9.73,9.73,0,0,0,.78,7.31,16.94,16.94,0,0,0,5.28,6.19c-1.82,1.26-3.65,2.49-5.53,3.64a63.8,63.8,0,0,1-7.66,4.07c-2.34,1-4.85,2.13-7.45,2.13.35-.9.65-1.64.91-2.4,2.45-7.07,1.13-13.47-3.71-19.09a13.16,13.16,0,0,0-11.8-4.78,15.83,15.83,0,0,0-5.69,1.83c-5.9,3.09-8.29,8.37-6.73,14.85.13.57.25,1.13.44,2a9.4,9.4,0,0,1-1.31-.45,3.93,3.93,0,0,0-4.26.35,14,14,0,0,0-1.71,1.23,22,22,0,0,0-7.48,13.05,11.57,11.57,0,0,0,4.67,11.66A15.79,15.79,0,0,0,404,362.5a19.55,19.55,0,0,0,6.95-1.82,37.62,37.62,0,0,0,13.45-10.43c.51-.6,1-1.23,1.45-1.81,1.43-.19,2.72-.39,4-.52,9.1-.87,17.32-6.72,24.28-12,.16-.12.31-.26.47-.37a3.22,3.22,0,0,0,1.18-1.89,17,17,0,0,0,7.27.46c1.06-.17,2.12-.38,3.66-.65-.86,1.19-1.45,2-2,2.78-2.87,4.11-5.83,8.16-8.56,12.37a37.86,37.86,0,0,0-5.91,16.26,16.34,16.34,0,0,0,1.4,9.09c2.39,5.15,9.1,8.42,15,5.86a30.52,30.52,0,0,0,7-4.13,66.46,66.46,0,0,0,8.77-8.25q13.51-15.37,25.84-31.75c.48-.64.92-1.31,1.36-2A2.21,2.21,0,0,0,509.48,331.17Zm-95.65,16.09c-1.91,2.05-3.76,4.17-5.82,6.05a31,31,0,0,1-4.89,3.44,5.53,5.53,0,0,1-4.26.76,4.1,4.1,0,0,1-1.14-3.07,15.17,15.17,0,0,1,1-6.18,29.59,29.59,0,0,1,4.71-8.31l2.07-2.67c1.4,1.49,2.74,3.1,4.27,4.51s3.25,2.65,5,4A9.31,9.31,0,0,1,413.83,347.26ZM426,325.93a13.62,13.62,0,0,1-.7,3.2,57.41,57.41,0,0,1-6.94,12.22c-.11.15-.32.22-.58.4a11.47,11.47,0,0,1-7.66-5.15,7.92,7.92,0,0,1,1.42-10.82c3.38-2.87,7.35-3.45,11.57-2.44a8.19,8.19,0,0,1,2.13,1.07A1.46,1.46,0,0,1,426,325.93Zm28.29,1.31a2.64,2.64,0,0,1-1.59.61,1.87,1.87,0,0,1-1.81-1.68,7.84,7.84,0,0,1,.4-4.43,20,20,0,0,1,8.09-10.14,2.77,2.77,0,0,1,2.9-.39,4.61,4.61,0,0,1,.11,4.27A32.39,32.39,0,0,1,454.3,327.24Z"
              />
            </clipPath>
          </defs>

          <path
            clip-path="url(#myClipPath)"
            fill="none"
            stroke="#000"
            stroke-width="9"
            stroke-dasharray={$s0length}
            stroke-dashoffset={$s0}
            d="M144.21,284.89s40.38-17.71,34.06-41c-7.57-27.86-66,11.09-91.78,52.65C66.36,329,37.93,395.47,102.38,396c31.83.26,89.31-75.18,89.31-75.18s3.33-12.36-8-13.81-32.76,39.15,18,22l-16.53,25.52s-9.59,11.6-1.46,22.33,36.32-33.41,44.09-34.57S248.69,339.78,253,336s16.8-10.15,9.41-18.56-26.52,13.25-26.52,13.25-10.44,14.3,1.16,28.8,32.19-2.32,32.19-2.32l20-16.53s6.09-22.91,27-13.37c11.57,5.28-18.29-10.12-22.35,9.89s15.95,7.25,22.62,1.74,9.08-12.12,9.08-15.72-2.39,19-.38,23.55c1.63,3.69.87,13.63,10,9.86s28.56-15.08,33.49-22.33,3.19-3.57,3.19-3.57-21.46-22.76-38-25.4,8.41-14.53,41.18-16.27,75.28-1.27,115,4.41"
            transform="translate(-55.05 -227)"
          />
          <path
            clip-path="url(#myClipPath)"
            fill="none"
            stroke="#000"
            stroke-width="9"
            d="M513,298.51"
            stroke-dasharray={$s1length}
            stroke-dashoffset={$s1}
            transform="translate(-55.05 -227)"
          />
          <line
            clip-path="url(#myClipPath)"
            stroke="black"
            stroke-width="9"
            stroke-dasharray={$s2length}
            stroke-dashoffset={$s2}
            x1="355.18"
            y1="13.01"
            x2="296.3"
            y2="198.04"
          />
          <path
            clip-path="url(#myClipPath)"
            class="cls-2"
            fill="none"
            stroke="black"
            stroke-width="9"
            stroke-dasharray={$s3length}
            stroke-dashoffset={$s3}
            d="M402.51,333.11s-16.17,16.43-7.37,22.91,22.19-7,22.19-7,13.44-9,11.75-19.14-6.39-10-11.75-10.52S404.42,321,405,325.45s1.5,13.86,9.75,16.3,21,1.27,27.09-4.47,18.87-8.23,21-19.54-6.42-11.87-12.13-6.79-.72,20.42,6.06,19.84,19.84-5.34,19.84-5.34S447.06,365,453.15,371.39s8.41,9.86,16.82,2.9,44.66-51.41,44.66-51.41"
            transform="translate(-55.05 -227)"
          />
        </svg>
        <!-- SVG End -->
        <p class="text-5xl xl:text-6xl">Creator</p>
        Code is more<em>art & opinion</em> than it is science, or math.
      </div>
    </div>
  </div>
</div>
